# 環境比較分析: Kaggle vs Jules (Sandbox)

## 概要
「自律進化エコシステム (PBT / Meta-Game Evolution)」の実装・運用において、Kaggleノートブック環境とJulesサンドボックス環境のどちらが適しているかを、技術的実現可能性、パフォーマンス、運用効率の観点から比較・検証しました。

## 結論
**Kaggle環境の使用を強く推奨します。**

Julesサンドボックス環境は、深層強化学習（Deep Reinforcement Learning）に必要なライブラリ（PyTorch）が欠如しており、かつGPUリソースがないため、目的とする「数千〜数万回の対戦を通じた本格的なモデル作成」は**技術的に不可能**です。

---

## 詳細比較

| 比較項目 | Kaggle Notebook | Jules Sandbox (現在) | 判定 |
| :--- | :--- | :--- | :--- |
| **GPU利用** | **あり** (P100 / T4 x2) | **なし** (CPUのみ) | 🏆 Kaggle |
| **MLライブラリ** | PyTorch, TensorFlow 等が標準搭載 | **PyTorch未搭載** (インストール不可/困難) | 🏆 Kaggle |
| **計算時間** | 最大 9時間 (連続実行) | 短時間のセッション (タイムアウトあり) | 🏆 Kaggle |
| **永続化** | Kaggle Datasets / Models で保存可能 | セッション終了時にファイル消失 | 🏆 Kaggle |
| **シミュレーション速度** | GPU並列化により高速 (推論込みで数千試合/分が可能) | CPU単体: ~110試合/秒 (ランダム時) <br> **推論込み: <1試合/秒 (推定)** | 🏆 Kaggle |
| **開発用途** | 学習パイプラインの実行 | コード記述、ビルド、小規模デバッグ | 🤝 使い分け |

### 1. ライブラリの欠如 (Fatal Issue)
Jules環境で `import torch` を実行した結果、`ModuleNotFoundError` が発生しました。
本プロジェクトのAIエージェント (`python/py_ai/agent/network.py`) は `torch.nn.Module` を使用する AlphaZero 形式のニューラルネットワークであるため、**Jules環境ではプログラムを起動することすらできません。**

### 2. パフォーマンスベンチマーク結果
Jules環境にて、ニューラルネットワークを使わない「ランダムな手」によるC++シミュレーションの速度を計測しました。

- **条件**: CPU実行、ランダムエージェント
- **結果**: 約 110 ゲーム / 秒
- **分析**:
    - これは「思考ゼロ」の速度です。AlphaZero方式では、1手ごとにニューラルネットワークの推論（Inference）とMCTS（モンテカルロ木探索）が必要です。
    - GPUがないCPU環境でNN推論を行うと、速度はここから1/100〜1/1000以下に低下します。
    - 数万回の対戦を行うには、Jules環境では数週間〜数ヶ月かかると推定されます（Kaggleなら数時間）。

### 3. PBT (Population-Based Training) の要件
PBTは複数のエージェントを並行して育て、定期的に総当たり戦を行う必要があります。
- **メモリ**: 複数のモデルをメモリに乗せる、または頻繁にロードする必要があります。Kaggleの16GB+ RAM/VRAMなら余裕ですが、サンドボックス環境ではメモリ不足のリスクがあります。
- **時間**: 「9時間」というKaggleの制限は、PBTの1世代を回すのに適した単位です。サンドボックスの短いセッションでは、1世代も回り切りません。

---

## 推奨ワークフロー

1.  **Jules (ここ)**:
    - C++シミュレータのバグ修正
    - AIロジック（MCTSなど）の単体テスト
    - Kaggle用スクリプト（`train.py`, `pbt_manager.py`）の作成
2.  **Kaggle**:
    - Julesで作成したコードをアップロード
    - GPUを使って長時間学習 (9時間 x N回)
    - 学習済みモデル (`.pth`) を生成
3.  **フィードバック**:
    - Kaggleで得られたログやエラーをJulesに共有し、修正を行う

**次のステップとして、Kaggleで実行するための「学習用スクリプト（PBT Manager）」の実装をJulesに依頼することを推奨します。**
