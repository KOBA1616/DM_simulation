# 6. メタゲーム進化 (Meta-Game Evolution)

## 6.1 Quality-Diversity (QD) Search (MAP-Elites)
- **Objective**: 「最強の1つ」ではなく「多様な100個」のデッキを発見する。
- **Problem**: 通常の強化学習や進化計算は「平均的に強いデッキ（例: 速攻）」という単一の局所解に収束しやすく、ユニークなコンボデッキやコントロールデッキが淘汰されてしまう。
- **Method**: **MAP-Elites (Multi-dimensional Archive of Phenotypic Elites)**
    - 2次元のマップ（グリッド）を用意し、軸に**「特徴的な指標（Feature Descriptors）」**を設定して、各セルの「王者（Elite）」を維持する。
    - **Dimensions (Feature Space)**:
        - **X軸**: ゲームスピード（平均決着ターン数: 早〜遅）
        - **Y軸**: リソース依存度（例: 1試合での最大墓地枚数、またはマナ使用総量: 少〜多）
    - **Process**:
        1.  既存のEliteデッキをコピーし、カードを数枚入れ替えて変異（Mutation）させる。
        2.  シミュレーションを行い、勝率と特徴量（X, Y）を計測する。
        3.  該当するグリッドのセルを確認し、「空席」または「既存のEliteより勝率が高い」場合、そのセルを新しいデッキで上書きする。
- **Realistic Implementation (現実的な実装規模)**:
    - **Grid Size**: 10x10 〜 12x12（約100〜144セル）。
        - 無闇に細かくせず、現実的な計算リソース（ローカルPC）で探索可能なサイズに留める。
    - **Evaluation**: 各変異体につき対ベースラインBot戦を100戦程度行い、統計的に信頼できる特徴量（平均値）を算出する。
- **Effect**:
    - 「墓地が大量にあり、かつ勝率が高い」セルが埋まれば、それは「墓地利用コンボ」の発見を意味する。
    - 「1ターンに大量にカードをプレイして勝った」セルは「ループコンボ」を示唆する。
    - 「速攻で殴り勝つ」という安易な正解に逃げず、多様な勝ち筋を持つデッキ群（メタゲーム）を自動生成できる。

## 6.2 Co-evolution of Deck & Play (デッキとプレイングの共進化)
- **Objective**: 既存のデッキリストに囚われず、AIにゼロから「カードの組み合わせ」を発見させる。
- **Method**:
    - **Random Initialization**: カードプール（例: 200種）からランダムに40枚を選んで初期デッキ群を生成する。
    - **Anomaly Detection (異常検知)**:
        - 生成されたデッキで数千回対戦を行い、勝率だけでなく**「異常なスタッツ」**を記録する。
        - **Metrics**: 1ターンのカードプレイ回数、マナブースト数、墓地肥やし枚数など。
    - **Rough Diamond Preservation**:
        - 勝率が悪くても、異常なスタッツ（外れ値）を記録したデッキは**「コンボの原石」**として破棄せずに残す。
    - **Mutation**:
        - 「原石」デッキの一部を変異（Mutation）させ、再挑戦させることで、偶然生まれたシナジーを実用的なコンボへと昇華させる。
- **Effect**: 人間が「弱い」と判断したカードの組み合わせから、未知の強力なシナジーやループコンボを発見する。
